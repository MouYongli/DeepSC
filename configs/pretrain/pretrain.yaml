defaults:
  - _self_
  - model: deepsc
  - dataset: tripleca

wandb_project: "DeepSC"
tags: ["l0", "5bin", "normal cellxgene dataset", "ce only", "adaptive ce loss"]
# Loss weights
enable_l0: True
enable_mse: False
enable_ce: True
l0_lambda: 0.1
ce_loss_weight: 1.0
mse_loss_weight: 0
#control the weight of mse loss
adaptive_mse_weight: False


weighted_ce_loss: False
mean_ce_loss: False
use_ldam_loss: True # LDAM loss开关
enable_adaptive_ce_loss: False
enable_alternating_ldam_mean_ce_loss: True
enable_warm_alternating_ldam_mean_ce_loss: False
# how to calculate weight of mse loss
use_hard_mse_loss: True
use_exp_mse_loss: False
use_interval_mse_loss: False
#Print details of mse loss in log
show_mse_loss_details: False
output_dir: "/home/angli/baseline/DeepSC/outputs/deepsc"

# interval loss configuration
interval_loss_log_stats: True
interval_loss_return_tensor: False
adaptive_strategy: "inverse_count"  # "inverse_count", "inverse_loss", "balanced"

#different mask probability on different bins
do_hard_mask: True

regression_loss_type: "huber"

data_path: "/home/angli/baseline/DeepSC/data/cellxgene/heart_normalized_data_csr/small/partition_0_sparse_norm_small.npz"
seed: 42
ckpt_dir: "/home/angli/baseline/DeepSC/ckpts/"
num_device: 3
valid_every: 500
model_name: "scbert"
grad_acc: 20
learning_rate: 5e-4
epoch: 10
batch_size: 13
num_bin: 5
save_ckpt_every: 3000

log_on_wandb_every: 20
sequence_length: 1000
plot_tsne_and_umap: False
draw_continuous_pred_label_scatter: True

# 新增warmup相关参数
use_warmup: False
warmup_ratio: 0.03
use_warmup_with_decay: False
use_scbert_scheduler: False
use_mogaide_scheduler: True

# 梯度检查相关参数
check_grad_flow: False  # 是否启用梯度检查
hydra:
  # Logging configuration: https://hydra.cc/docs/tutorials/basic/running_your_app/logging/
  verbose: False
  # Logs to stdout and to a file.
  job_logging:
    handlers:
      console:
        class: logging.StreamHandler
        stream: ext://sys.stdout
      file:
        filename:
          ${hydra.runtime.output_dir}/${hydra.job.name}_${oc.select:hydra.job.num, 0}.log

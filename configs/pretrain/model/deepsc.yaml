_target_: src.deepsc.models.deepsc.model.DeepSC
embedding_dim: 256
num_genes: 34682
num_layers: 10
attn_dropout: 0.1
ffn_dropout: 0.1
fused: true
num_bins: ${num_bin}
alpha: 0.3
num_heads: 8
mask_layer_start: 2
enable_l0: ${enable_l0}
enable_mse: ${enable_mse}
enable_ce: ${enable_ce}
num_layers_ffn: 6
use_moe_regressor: ${use_moe_regressor}
use_M_matrix: ${use_M_matrix}

moe:
  expert_parallelism: ${expert_parallelism}
  n_moe_layers: 1
  use_moe_ffn: ${use_moe_ffn}
  dim: ${..embedding_dim}
  moe_inter_dim: 512
  n_routed_experts: 8
  n_activated_experts: 2
  n_expert_groups: 1
  topk_groups: 1
  n_limited_groups: 1
  n_shared_experts: 1
  score_func: "softmax"
  route_scale: 1.0
  world_size: ${oc.env:WORLD_SIZE,1}
  rank: ${oc.env:RANK,0}
